<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>密码学实验 | Ky不是枕木</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>:root {
 --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
 --light-background: url('/img/bk.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);document.addEventListener('pjax:success', _ => bszCaller.fetch(
 "//busuanzi.ibruce.info/busuanzi?jsonpCallback=BusuanziCallback", a => {
  bszTag.texts(a),
  bszTag.shows()
}));reset()})</script><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Ky不是枕木" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>密码学实验</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-04-10T15:14:29.000Z" id="date"> 2023-04-10</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-05-05T12:10:42.242Z" id="updated"> 2023-05-05</time></div></span><br><span>Word Count: <div class="control">5.4k</div></span><br><span>Read Time: <div class="control">31 min</div></span><br><span id="busuanzi_container_page_pv">Page View: <span class="control" id="busuanzi_value_page_pv">loading...</span></span></div></div><hr><div id="post-content"><h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function">string <span class="hljs-title">string_to_hex</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; str)</span> <span class="hljs-comment">//字符串转化为十六进制</span></span><br><span class="hljs-function"></span>{<br>    string result=<span class="hljs-string">""</span>;<br>    string tmp;<br>    stringstream ss;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;str.<span class="hljs-built_in">size</span>();i++)<br>    {<br>        ss&lt;&lt;hex&lt;&lt;<span class="hljs-built_in">int</span>(str[i])&lt;&lt;endl;<br>        ss&gt;&gt;tmp;<br>        result+=tmp;<br>    }<br>    <span class="hljs-keyword">return</span> result;<br>}<br><span class="hljs-function">string <span class="hljs-title">hex_to_string</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; str)</span></span><br><span class="hljs-function"></span>{<br>    std::string result;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-built_in">length</span>(); i += <span class="hljs-number">2</span>)<span class="hljs-comment">//十六进制两个字符为原始字符一个字符</span><br>    {<br>        std::string byte = str.<span class="hljs-built_in">substr</span>(i, <span class="hljs-number">2</span>);<span class="hljs-comment">//每次切两个字符</span><br>        <span class="hljs-comment">//将十六进制的string转成long再强转成int再转成char</span><br>        <span class="hljs-type">char</span> chr = (<span class="hljs-type">char</span>)(<span class="hljs-type">int</span>)<span class="hljs-built_in">strtol</span>(byte.<span class="hljs-built_in">c_str</span>(), <span class="hljs-literal">NULL</span>, <span class="hljs-number">16</span>);<br>        result.<span class="hljs-built_in">push_back</span>(chr);<span class="hljs-comment">//将处理完的字符压入result中</span><br>    }<br>    <span class="hljs-keyword">return</span> result;<br>}<br><br><span class="hljs-function">string <span class="hljs-title">hex2bin</span><span class="hljs-params">(string s)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-comment">//十六进制转化为二进制</span><br>    unordered_map&lt;<span class="hljs-type">char</span>, string&gt; mp;<br>    mp[<span class="hljs-string">'0'</span>] = <span class="hljs-string">"0000"</span>;<br>    mp[<span class="hljs-string">'1'</span>] = <span class="hljs-string">"0001"</span>;<br>    mp[<span class="hljs-string">'2'</span>] = <span class="hljs-string">"0010"</span>;<br>    mp[<span class="hljs-string">'3'</span>] = <span class="hljs-string">"0011"</span>;<br>    mp[<span class="hljs-string">'4'</span>] = <span class="hljs-string">"0100"</span>;<br>    mp[<span class="hljs-string">'5'</span>] = <span class="hljs-string">"0101"</span>;<br>    mp[<span class="hljs-string">'6'</span>] = <span class="hljs-string">"0110"</span>;<br>    mp[<span class="hljs-string">'7'</span>] = <span class="hljs-string">"0111"</span>;<br>    mp[<span class="hljs-string">'8'</span>] = <span class="hljs-string">"1000"</span>;<br>    mp[<span class="hljs-string">'9'</span>] = <span class="hljs-string">"1001"</span>;<br>    mp[<span class="hljs-string">'A'</span>] = <span class="hljs-string">"1010"</span>;<br>    mp[<span class="hljs-string">'B'</span>] = <span class="hljs-string">"1011"</span>;<br>    mp[<span class="hljs-string">'C'</span>] = <span class="hljs-string">"1100"</span>;<br>    mp[<span class="hljs-string">'D'</span>] = <span class="hljs-string">"1101"</span>;<br>    mp[<span class="hljs-string">'E'</span>] = <span class="hljs-string">"1110"</span>;<br>    mp[<span class="hljs-string">'F'</span>] = <span class="hljs-string">"1111"</span>;<br>    string bin = <span class="hljs-string">""</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; s.<span class="hljs-built_in">size</span>(); i++) {<br>        bin += mp[s[i]];<br>    }<br>    <span class="hljs-keyword">return</span> bin;<br>}<br><span class="hljs-function">string <span class="hljs-title">bin2hex</span><span class="hljs-params">(string s)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-comment">// 二进制转化为16进制</span><br>    unordered_map&lt;string, string&gt; mp;<br>    mp[<span class="hljs-string">"0000"</span>] = <span class="hljs-string">"0"</span>;<br>    mp[<span class="hljs-string">"0001"</span>] = <span class="hljs-string">"1"</span>;<br>    mp[<span class="hljs-string">"0010"</span>] = <span class="hljs-string">"2"</span>;<br>    mp[<span class="hljs-string">"0011"</span>] = <span class="hljs-string">"3"</span>;<br>    mp[<span class="hljs-string">"0100"</span>] = <span class="hljs-string">"4"</span>;<br>    mp[<span class="hljs-string">"0101"</span>] = <span class="hljs-string">"5"</span>;<br>    mp[<span class="hljs-string">"0110"</span>] = <span class="hljs-string">"6"</span>;<br>    mp[<span class="hljs-string">"0111"</span>] = <span class="hljs-string">"7"</span>;<br>    mp[<span class="hljs-string">"1000"</span>] = <span class="hljs-string">"8"</span>;<br>    mp[<span class="hljs-string">"1001"</span>] = <span class="hljs-string">"9"</span>;<br>    mp[<span class="hljs-string">"1010"</span>] = <span class="hljs-string">"A"</span>;<br>    mp[<span class="hljs-string">"1011"</span>] = <span class="hljs-string">"B"</span>;<br>    mp[<span class="hljs-string">"1100"</span>] = <span class="hljs-string">"C"</span>;<br>    mp[<span class="hljs-string">"1101"</span>] = <span class="hljs-string">"D"</span>;<br>    mp[<span class="hljs-string">"1110"</span>] = <span class="hljs-string">"E"</span>;<br>    mp[<span class="hljs-string">"1111"</span>] = <span class="hljs-string">"F"</span>;<br>    string hex = <span class="hljs-string">""</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; s.<span class="hljs-built_in">length</span>(); i += <span class="hljs-number">4</span>) {<br>        string ch = <span class="hljs-string">""</span>;<br>        ch += s[i];<br>        ch += s[i + <span class="hljs-number">1</span>];<br>        ch += s[i + <span class="hljs-number">2</span>];<br>        ch += s[i + <span class="hljs-number">3</span>];<br>        hex += mp[ch];<br>    }<br>    <span class="hljs-keyword">return</span> hex;<br>}<br><br><span class="hljs-function">string <span class="hljs-title">permute</span><span class="hljs-params">(string k, <span class="hljs-type">int</span>* arr, <span class="hljs-type">int</span> n)</span></span><br><span class="hljs-function"></span>{<br>    string per = <span class="hljs-string">""</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {<br>        per += k[arr[i] - <span class="hljs-number">1</span>];<br>    }<br>    <span class="hljs-keyword">return</span> per;<br>}<br><br><span class="hljs-function">string <span class="hljs-title">shift_left</span><span class="hljs-params">(string k, <span class="hljs-type">int</span> shifts)</span></span><br><span class="hljs-function"></span>{<br>    string s = <span class="hljs-string">""</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; shifts; i++) {<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt; <span class="hljs-number">28</span>; j++) {<br>            s += k[j];<br>        }<br>        s += k[<span class="hljs-number">0</span>];<br>        k = s;<br>        s = <span class="hljs-string">""</span>;<br>    }<br>    <span class="hljs-keyword">return</span> k;<br>}<br><br><span class="hljs-function">string <span class="hljs-title">xor_</span><span class="hljs-params">(string a, string b)</span></span><br><span class="hljs-function"></span>{<br>    string ans = <span class="hljs-string">""</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; a.<span class="hljs-built_in">size</span>(); i++) {<br>        <span class="hljs-keyword">if</span> (a[i] == b[i]) {<br>            ans += <span class="hljs-string">"0"</span>;<br>        }<br>        <span class="hljs-keyword">else</span> {<br>            ans += <span class="hljs-string">"1"</span>;<br>        }<br>    }<br>    <span class="hljs-keyword">return</span> ans;<br>}<br><span class="hljs-function">string <span class="hljs-title">encrypt</span><span class="hljs-params">(string pt, vector&lt;string&gt; rkb,</span></span><br><span class="hljs-params"><span class="hljs-function">               vector&lt;string&gt; rk)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-comment">// 16-&gt;2</span><br>    pt = <span class="hljs-built_in">hex2bin</span>(pt);<br><br>    <span class="hljs-comment">// 初始置换</span><br>    <span class="hljs-type">int</span> initial_perm[<span class="hljs-number">64</span>]<br>            = { <span class="hljs-number">58</span>, <span class="hljs-number">50</span>, <span class="hljs-number">42</span>, <span class="hljs-number">34</span>, <span class="hljs-number">26</span>, <span class="hljs-number">18</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">60</span>, <span class="hljs-number">52</span>, <span class="hljs-number">44</span>,<br>                <span class="hljs-number">36</span>, <span class="hljs-number">28</span>, <span class="hljs-number">20</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">62</span>, <span class="hljs-number">54</span>, <span class="hljs-number">46</span>, <span class="hljs-number">38</span>, <span class="hljs-number">30</span>, <span class="hljs-number">22</span>,<br>                <span class="hljs-number">14</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">64</span>, <span class="hljs-number">56</span>, <span class="hljs-number">48</span>, <span class="hljs-number">40</span>, <span class="hljs-number">32</span>, <span class="hljs-number">24</span>, <span class="hljs-number">16</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">57</span>,<br>                <span class="hljs-number">49</span>, <span class="hljs-number">41</span>, <span class="hljs-number">33</span>, <span class="hljs-number">25</span>, <span class="hljs-number">17</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">59</span>, <span class="hljs-number">51</span>, <span class="hljs-number">43</span>, <span class="hljs-number">35</span>,<br>                <span class="hljs-number">27</span>, <span class="hljs-number">19</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">61</span>, <span class="hljs-number">53</span>, <span class="hljs-number">45</span>, <span class="hljs-number">37</span>, <span class="hljs-number">29</span>, <span class="hljs-number">21</span>, <span class="hljs-number">13</span>,<br>                <span class="hljs-number">5</span>,  <span class="hljs-number">63</span>, <span class="hljs-number">55</span>, <span class="hljs-number">47</span>, <span class="hljs-number">39</span>, <span class="hljs-number">31</span>, <span class="hljs-number">23</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span> };<br>    <span class="hljs-comment">// 初始置换</span><br>    pt = <span class="hljs-built_in">permute</span>(pt, initial_perm, <span class="hljs-number">64</span>);<br>    cout &lt;&lt; <span class="hljs-string">"初始置换后: "</span> &lt;&lt; <span class="hljs-built_in">bin2hex</span>(pt)<br>         &lt;&lt; endl;<br><br>    <span class="hljs-comment">// 拆分成左右32比特</span><br>    string left = pt.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>);<br>    string right = pt.<span class="hljs-built_in">substr</span>(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>);<br>    cout &lt;&lt; <span class="hljs-string">"拆分后: L0="</span> &lt;&lt; <span class="hljs-built_in">bin2hex</span>(left)<br>         &lt;&lt; <span class="hljs-string">" R0="</span> &lt;&lt; <span class="hljs-built_in">bin2hex</span>(right) &lt;&lt; endl;<br><br>    <span class="hljs-comment">// E盒扩展</span><br>    <span class="hljs-type">int</span> exp_d[<span class="hljs-number">48</span>]<br>            = { <span class="hljs-number">32</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>,<br>                <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>,<br>                <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>,<br>                <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">32</span>, <span class="hljs-number">1</span> };<br><br>    <span class="hljs-comment">// S盒</span><br>    <span class="hljs-type">int</span> s[<span class="hljs-number">8</span>][<span class="hljs-number">4</span>][<span class="hljs-number">16</span>] = {<br>            { <span class="hljs-number">14</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">5</span>,<span class="hljs-number">9</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">6</span>,<span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">13</span> },<br>            { <span class="hljs-number">15</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">9</span> },<br>			{ <span class="hljs-number">10</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">12</span> },<br>            { <span class="hljs-number">7</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">14</span> },<br>            { <span class="hljs-number">2</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">3</span> },<br>            { <span class="hljs-number">12</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">11</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">13</span> },<br>            { <span class="hljs-number">4</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">13</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">14</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">12</span> },<br>            { <span class="hljs-number">13</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">11</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">0</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">11</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">10</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">11</span> }<br>    };<br><br>    <span class="hljs-comment">// P盒置换</span><br>    <span class="hljs-type">int</span> per[<span class="hljs-number">32</span>]<br>            = { <span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">29</span>, <span class="hljs-number">12</span>, <span class="hljs-number">28</span>, <span class="hljs-number">17</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">23</span>,<br>                <span class="hljs-number">26</span>, <span class="hljs-number">5</span>, <span class="hljs-number">18</span>, <span class="hljs-number">31</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">24</span>, <span class="hljs-number">14</span>, <span class="hljs-number">32</span>, <span class="hljs-number">27</span>,<br>                <span class="hljs-number">3</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">19</span>, <span class="hljs-number">13</span>, <span class="hljs-number">30</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">22</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>,  <span class="hljs-number">25</span> };<br><br>    cout &lt;&lt; endl;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++) {<br>        string right_expanded = <span class="hljs-built_in">permute</span>(right, exp_d, <span class="hljs-number">48</span>);<br><br>        string x = <span class="hljs-built_in">xor_</span>(rkb[i], right_expanded);<br><br>        <span class="hljs-comment">// S</span><br>        string op = <span class="hljs-string">""</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) {<br>            <span class="hljs-type">int</span> row = <span class="hljs-number">2</span> * <span class="hljs-built_in">int</span>(x[i * <span class="hljs-number">6</span>] - <span class="hljs-string">'0'</span>)<br>                      + <span class="hljs-built_in">int</span>(x[i * <span class="hljs-number">6</span> + <span class="hljs-number">5</span>] - <span class="hljs-string">'0'</span>);<br>            <span class="hljs-type">int</span> col = <span class="hljs-number">8</span> * <span class="hljs-built_in">int</span>(x[i * <span class="hljs-number">6</span> + <span class="hljs-number">1</span>] - <span class="hljs-string">'0'</span>)<br>                      + <span class="hljs-number">4</span> * <span class="hljs-built_in">int</span>(x[i * <span class="hljs-number">6</span> + <span class="hljs-number">2</span>] - <span class="hljs-string">'0'</span>)<br>                      + <span class="hljs-number">2</span> * <span class="hljs-built_in">int</span>(x[i * <span class="hljs-number">6</span> + <span class="hljs-number">3</span>] - <span class="hljs-string">'0'</span>)<br>                      + <span class="hljs-built_in">int</span>(x[i * <span class="hljs-number">6</span> + <span class="hljs-number">4</span>] - <span class="hljs-string">'0'</span>);<br>            <span class="hljs-type">int</span> val = s[i][row][col];<br>            op += <span class="hljs-built_in">char</span>(val / <span class="hljs-number">8</span> + <span class="hljs-string">'0'</span>);<br>            val = val % <span class="hljs-number">8</span>;<br>            op += <span class="hljs-built_in">char</span>(val / <span class="hljs-number">4</span> + <span class="hljs-string">'0'</span>);<br>            val = val % <span class="hljs-number">4</span>;<br>            op += <span class="hljs-built_in">char</span>(val / <span class="hljs-number">2</span> + <span class="hljs-string">'0'</span>);<br>            val = val % <span class="hljs-number">2</span>;<br>            op += <span class="hljs-built_in">char</span>(val + <span class="hljs-string">'0'</span>);<br>        }<br>        op = <span class="hljs-built_in">permute</span>(op, per, <span class="hljs-number">32</span>);<br><br>        x = <span class="hljs-built_in">xor_</span>(op, left);<br><br>        left = x;<br><br>        <span class="hljs-comment">// 交换左右</span><br>        <span class="hljs-keyword">if</span> (i != <span class="hljs-number">15</span>) {<br>            <span class="hljs-built_in">swap</span>(left, right);<br>        }<br>        cout &lt;&lt; <span class="hljs-string">"轮数: "</span> &lt;&lt; i + <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">" "</span> &lt;&lt; <span class="hljs-built_in">bin2hex</span>(left)<br>             &lt;&lt; <span class="hljs-string">" "</span> &lt;&lt; <span class="hljs-built_in">bin2hex</span>(right) &lt;&lt; <span class="hljs-string">" "</span> &lt;&lt; rk[i]<br>             &lt;&lt; endl;<br>    }<br><br>    <span class="hljs-comment">// 左右结合</span><br>    string combine = left + right;<br><br>    <span class="hljs-comment">// IP逆置换</span><br>    <span class="hljs-type">int</span> final_perm[<span class="hljs-number">64</span>]<br>            = { <span class="hljs-number">40</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">48</span>, <span class="hljs-number">16</span>, <span class="hljs-number">56</span>, <span class="hljs-number">24</span>, <span class="hljs-number">64</span>, <span class="hljs-number">32</span>, <span class="hljs-number">39</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">47</span>,<br>                <span class="hljs-number">15</span>, <span class="hljs-number">55</span>, <span class="hljs-number">23</span>, <span class="hljs-number">63</span>, <span class="hljs-number">31</span>, <span class="hljs-number">38</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">46</span>, <span class="hljs-number">14</span>, <span class="hljs-number">54</span>, <span class="hljs-number">22</span>,<br>                <span class="hljs-number">62</span>, <span class="hljs-number">30</span>, <span class="hljs-number">37</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">45</span>, <span class="hljs-number">13</span>, <span class="hljs-number">53</span>, <span class="hljs-number">21</span>, <span class="hljs-number">61</span>, <span class="hljs-number">29</span>, <span class="hljs-number">36</span>,<br>                <span class="hljs-number">4</span>,  <span class="hljs-number">44</span>, <span class="hljs-number">12</span>, <span class="hljs-number">52</span>, <span class="hljs-number">20</span>, <span class="hljs-number">60</span>, <span class="hljs-number">28</span>, <span class="hljs-number">35</span>, <span class="hljs-number">3</span>,  <span class="hljs-number">43</span>, <span class="hljs-number">11</span>,<br>                <span class="hljs-number">51</span>, <span class="hljs-number">19</span>, <span class="hljs-number">59</span>, <span class="hljs-number">27</span>, <span class="hljs-number">34</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">42</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>, <span class="hljs-number">18</span>, <span class="hljs-number">58</span>,<br>                <span class="hljs-number">26</span>, <span class="hljs-number">33</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">41</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">49</span>, <span class="hljs-number">17</span>, <span class="hljs-number">57</span>, <span class="hljs-number">25</span> };<br><br>    string cipher = <span class="hljs-built_in">bin2hex</span>(<span class="hljs-built_in">permute</span>(combine, final_perm, <span class="hljs-number">64</span>));<br>    <span class="hljs-keyword">return</span> cipher;<br>}<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>{<br>    string pt, key;<br>    cout&lt;&lt;<span class="hljs-string">"请输入明文: "</span>;<br>    cin&gt;&gt;pt;<br>    cout&lt;&lt;<span class="hljs-string">"请输入密文: "</span>;<br>    cin&gt;&gt;key;<br>    pt = <span class="hljs-built_in">string_to_hex</span>(pt);<br>    cout&lt;&lt;pt;<br>    key = <span class="hljs-built_in">string_to_hex</span>(key);<br>    key = <span class="hljs-built_in">hex2bin</span>(key);<br>    <span class="hljs-type">int</span> keyp[<span class="hljs-number">56</span>]<br>            = { <span class="hljs-number">57</span>, <span class="hljs-number">49</span>, <span class="hljs-number">41</span>, <span class="hljs-number">33</span>, <span class="hljs-number">25</span>, <span class="hljs-number">17</span>, <span class="hljs-number">9</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">58</span>, <span class="hljs-number">50</span>, <span class="hljs-number">42</span>, <span class="hljs-number">34</span>,<br>                <span class="hljs-number">26</span>, <span class="hljs-number">18</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>,  <span class="hljs-number">59</span>, <span class="hljs-number">51</span>, <span class="hljs-number">43</span>, <span class="hljs-number">35</span>, <span class="hljs-number">27</span>, <span class="hljs-number">19</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>,<br>                <span class="hljs-number">60</span>, <span class="hljs-number">52</span>, <span class="hljs-number">44</span>, <span class="hljs-number">36</span>, <span class="hljs-number">63</span>, <span class="hljs-number">55</span>, <span class="hljs-number">47</span>, <span class="hljs-number">39</span>, <span class="hljs-number">31</span>, <span class="hljs-number">23</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>,<br>                <span class="hljs-number">62</span>, <span class="hljs-number">54</span>, <span class="hljs-number">46</span>, <span class="hljs-number">38</span>, <span class="hljs-number">30</span>, <span class="hljs-number">22</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">61</span>, <span class="hljs-number">53</span>, <span class="hljs-number">45</span>, <span class="hljs-number">37</span>,<br>                <span class="hljs-number">29</span>, <span class="hljs-number">21</span>, <span class="hljs-number">13</span>, <span class="hljs-number">5</span>,  <span class="hljs-number">28</span>, <span class="hljs-number">20</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span> };<br><br>    <span class="hljs-comment">//密钥生成</span><br>    key = <span class="hljs-built_in">permute</span>(key, keyp, <span class="hljs-number">56</span>);<br><br>    <span class="hljs-type">int</span> shift_table[<span class="hljs-number">16</span>] = { <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>,<br>                            <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span> };<br><br>    <span class="hljs-type">int</span> key_comp[<span class="hljs-number">48</span>] = { <span class="hljs-number">14</span>, <span class="hljs-number">17</span>, <span class="hljs-number">11</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">28</span>,<br>                         <span class="hljs-number">15</span>, <span class="hljs-number">6</span>,  <span class="hljs-number">21</span>, <span class="hljs-number">10</span>, <span class="hljs-number">23</span>, <span class="hljs-number">19</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>,<br>                         <span class="hljs-number">26</span>, <span class="hljs-number">8</span>,  <span class="hljs-number">16</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">27</span>, <span class="hljs-number">20</span>, <span class="hljs-number">13</span>, <span class="hljs-number">2</span>,<br>                         <span class="hljs-number">41</span>, <span class="hljs-number">52</span>, <span class="hljs-number">31</span>, <span class="hljs-number">37</span>, <span class="hljs-number">47</span>, <span class="hljs-number">55</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>,<br>                         <span class="hljs-number">51</span>, <span class="hljs-number">45</span>, <span class="hljs-number">33</span>, <span class="hljs-number">48</span>, <span class="hljs-number">44</span>, <span class="hljs-number">49</span>, <span class="hljs-number">39</span>, <span class="hljs-number">56</span>,<br>                         <span class="hljs-number">34</span>, <span class="hljs-number">53</span>, <span class="hljs-number">46</span>, <span class="hljs-number">42</span>, <span class="hljs-number">50</span>, <span class="hljs-number">36</span>, <span class="hljs-number">29</span>, <span class="hljs-number">32</span> };<br>    string left = key.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, <span class="hljs-number">28</span>);<br>    string right = key.<span class="hljs-built_in">substr</span>(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>);<br><br>    vector&lt;string&gt; rkb;<br>    vector&lt;string&gt; rk;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++) {<br>        left = <span class="hljs-built_in">shift_left</span>(left, shift_table[i]);<br>        right = <span class="hljs-built_in">shift_left</span>(right, shift_table[i]);<br><br>        string combine = left + right;<br><br>        string RoundKey = <span class="hljs-built_in">permute</span>(combine, key_comp, <span class="hljs-number">48</span>);<br><br>        rkb.<span class="hljs-built_in">push_back</span>(RoundKey);<br>        rk.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">bin2hex</span>(RoundKey));<br>    }<br><br>    cout &lt;&lt; <span class="hljs-string">"加密:\n"</span>;<br>    string cipher = <span class="hljs-built_in">encrypt</span>(pt, rkb, rk);<br>    cout &lt;&lt; <span class="hljs-string">"密文: "</span> &lt;&lt; cipher &lt;&lt; endl;<br><br>    cout &lt;&lt; <span class="hljs-string">"解密:\n"</span>;<br>    <span class="hljs-built_in">reverse</span>(rkb.<span class="hljs-built_in">begin</span>(), rkb.<span class="hljs-built_in">end</span>());<br>    <span class="hljs-built_in">reverse</span>(rk.<span class="hljs-built_in">begin</span>(), rk.<span class="hljs-built_in">end</span>());<br>    string text = <span class="hljs-built_in">encrypt</span>(cipher, rkb, rk);<br>    text = <span class="hljs-built_in">hex_to_string</span>(text);<br>    cout &lt;&lt; <span class="hljs-string">"明文: "</span> &lt;&lt; text &lt;&lt; endl;<br>}<br></code></pre></td></tr></tbody></table></figure>



<h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iomanip&gt;</span></span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">AddRoundKey</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> mtx[],<span class="hljs-type">uint32_t</span> w[])</span></span>;<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">SubKeys</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> temp)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SubBytes</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> mtx[],<span class="hljs-type">int</span> len)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">KeyExpansion</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> key[], <span class="hljs-type">uint32_t</span> new_key[])</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Display</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> Matrix[])</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DisplayKeys</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> Matrix[][<span class="hljs-number">16</span>])</span></span>;<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">left_bit_move</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> val, <span class="hljs-type">int</span> n)</span></span>;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">uint32_t</span> T[<span class="hljs-number">4</span>][<span class="hljs-number">256</span>];<span class="hljs-comment">//存储4张列混淆表</span><br><span class="hljs-type">int</span> mixCol[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>] = {<br>        {<span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x01</span>},<br>        {<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>},<br>        {<span class="hljs-number">0x01</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>},<br>        {<span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>}<br>};<span class="hljs-comment">//列混淆矩阵</span><br><span class="hljs-type">uint8_t</span> S_Box[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>] =<br>        {<br>                {<span class="hljs-number">0x63</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>},<br>                {<span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>},<br>                {<span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>},<br>                {<span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>},<br>                {<span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>},<br>                {<span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>},<br>                {<span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>},<br>                {<span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>},<br>                {<span class="hljs-number">0xCD</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>},<br>                {<span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>},<br>                {<span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>},<br>                {<span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>},<br>                {<span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>},<br>                {<span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>},<br>                {<span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>},<br>                {<span class="hljs-number">0x8C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span>}<br>        };<br><span class="hljs-comment">//逆S盒</span><br><span class="hljs-type">uint8_t</span> Inv_S_Box[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>] =<br>        {<br>                {<span class="hljs-number">0x52</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xFB</span>},<br>                {<span class="hljs-number">0x7C</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCB</span>},<br>                {<span class="hljs-number">0x54</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x4E</span>},<br>                {<span class="hljs-number">0x08</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x25</span>},<br>                {<span class="hljs-number">0x72</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x92</span>},<br>                {<span class="hljs-number">0x6C</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x84</span>},<br>                {<span class="hljs-number">0x90</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x06</span>},<br>                {<span class="hljs-number">0xD0</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x6B</span>},<br>                {<span class="hljs-number">0x3A</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x73</span>},<br>                {<span class="hljs-number">0x96</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x6E</span>},<br>                {<span class="hljs-number">0x47</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x1B</span>},<br>                {<span class="hljs-number">0xFC</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xF4</span>},<br>                {<span class="hljs-number">0x1F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>},<br>                {<span class="hljs-number">0x60</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xEF</span>},<br>                {<span class="hljs-number">0xA0</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x61</span>},<br>                {<span class="hljs-number">0x17</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x7D</span>}<br>        };<br><span class="hljs-comment">//轮密钥加</span><br><span class="hljs-type">uint32_t</span> LunMiYaoJia[<span class="hljs-number">10</span>] = {<span class="hljs-number">0x01000000</span>, <span class="hljs-number">0x02000000</span>, <span class="hljs-number">0x04000000</span>, <span class="hljs-number">0x08000000</span>, <span class="hljs-number">0x10000000</span>,<br>                            <span class="hljs-number">0x20000000</span>, <span class="hljs-number">0x40000000</span>, <span class="hljs-number">0x80000000</span>, <span class="hljs-number">0x1b000000</span>, <span class="hljs-number">0x36000000</span>};<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">left_bit_move</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> val, <span class="hljs-type">int</span> n)</span> </span>{<br>    <span class="hljs-type">uint32_t</span> size = <span class="hljs-built_in">sizeof</span>(val) * <span class="hljs-number">8</span>;<br>    n = n % size;<br>    <span class="hljs-keyword">return</span> (val &gt;&gt; (size - n) | (val &lt;&lt; n));<span class="hljs-comment">//左移</span><br>    <span class="hljs-comment">//return (val &lt;&lt; (size - n) | (val &gt;&gt; n));//右移</span><br>}<br><span class="hljs-function">string <span class="hljs-title">string_to_hex</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; str)</span> <span class="hljs-comment">//字符串转化为十六进制</span></span><br><span class="hljs-function"></span>{<br>    string result=<span class="hljs-string">""</span>;<br>    string tmp;<br>    stringstream ss;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;str.<span class="hljs-built_in">size</span>();i++)<br>    {<br>        ss&lt;&lt;hex&lt;&lt;<span class="hljs-built_in">int</span>(str[i])&lt;&lt;endl;<br>        ss&gt;&gt;tmp;<br>        result+=tmp;<br>    }<br>    <span class="hljs-keyword">return</span> result;<br>}<br><span class="hljs-function">string <span class="hljs-title">hex_to_string</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; str)</span></span><br><span class="hljs-function"></span>{<br>    std::string result;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-built_in">length</span>(); i += <span class="hljs-number">2</span>)<span class="hljs-comment">//十六进制两个字符为原始字符一个字符</span><br>    {<br>        std::string byte = str.<span class="hljs-built_in">substr</span>(i, <span class="hljs-number">2</span>);<span class="hljs-comment">//每次切两个字符</span><br>        <span class="hljs-comment">//将十六进制的string转成long再强转成int再转成char</span><br>        <span class="hljs-type">char</span> chr = (<span class="hljs-type">char</span>)(<span class="hljs-type">int</span>)<span class="hljs-built_in">strtol</span>(byte.<span class="hljs-built_in">c_str</span>(), <span class="hljs-literal">NULL</span>, <span class="hljs-number">16</span>);<br>        result.<span class="hljs-built_in">push_back</span>(chr);<span class="hljs-comment">//将处理完的字符压入result中</span><br>    }<br>    <span class="hljs-keyword">return</span> result;<br>}<br><span class="hljs-comment">//制作列混淆表</span><br><span class="hljs-function"><span class="hljs-type">uint8_t</span> <span class="hljs-title">Mul_02</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> x)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">if</span>((x&gt;&gt;<span class="hljs-number">7</span>) == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> x&lt;&lt;<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">return</span> ((x&lt;&lt;<span class="hljs-number">1</span>)^<span class="hljs-number">0x1b</span>)&amp;<span class="hljs-number">0xff</span>;<br>}<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">get_output_col1</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> x)</span></span><br><span class="hljs-function"></span>{<br>    x = (<span class="hljs-type">uint32_t</span>)x;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">Mul_02</span>(x)&lt;&lt;<span class="hljs-number">24</span>)|(x&lt;&lt;<span class="hljs-number">16</span>)|(x&lt;&lt;<span class="hljs-number">8</span>)|(x^ <span class="hljs-built_in">Mul_02</span>(x));<br>    <span class="hljs-comment">//2113</span><br>}<br><br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">get_output_col2</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> x)</span></span><br><span class="hljs-function"></span>{<br>    x = (<span class="hljs-type">uint32_t</span>)x;<br>    <span class="hljs-keyword">return</span> ((x^<span class="hljs-built_in">Mul_02</span>(x))&lt;&lt;<span class="hljs-number">24</span>)|(<span class="hljs-built_in">Mul_02</span>(x)&lt;&lt;<span class="hljs-number">16</span>)|(x&lt;&lt;<span class="hljs-number">8</span>)|(x);<br>    <span class="hljs-comment">//3211</span><br>}<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">get_output_col3</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> x)</span></span><br><span class="hljs-function"></span>{<br>    x = (<span class="hljs-type">uint32_t</span>)x;<br>    <span class="hljs-keyword">return</span> (x&lt;&lt;<span class="hljs-number">24</span>)|((x^<span class="hljs-built_in">Mul_02</span>(x))&lt;&lt;<span class="hljs-number">16</span>)|(<span class="hljs-built_in">Mul_02</span>(x)&lt;&lt;<span class="hljs-number">8</span>)|(x);<br>    <span class="hljs-comment">//1321</span><br>}<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">get_output_col4</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> x)</span></span><br><span class="hljs-function"></span>{<br>    x = (<span class="hljs-type">uint32_t</span>)x;<br>    <span class="hljs-keyword">return</span> (x&lt;&lt;<span class="hljs-number">24</span>)|(x&lt;&lt;<span class="hljs-number">16</span>)|((x^<span class="hljs-built_in">Mul_02</span>(x))&lt;&lt;<span class="hljs-number">8</span>)|(<span class="hljs-built_in">Mul_02</span>(x));<br>    <span class="hljs-comment">//1132</span><br>}<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">get_TAB</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++) {<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">256</span>; j++) {<br>            T[i][j]=<span class="hljs-number">0</span>;<br>        }<br>    }<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">256</span>;i++) {<br>        T[<span class="hljs-number">0</span>][i] = <span class="hljs-built_in">get_output_col1</span>((<span class="hljs-type">uint8_t</span>) i);<br>        T[<span class="hljs-number">1</span>][i] = <span class="hljs-built_in">get_output_col2</span>((<span class="hljs-type">uint8_t</span>) i);<br>        T[<span class="hljs-number">2</span>][i] = <span class="hljs-built_in">get_output_col3</span>((<span class="hljs-type">uint8_t</span>) i);<br>        T[<span class="hljs-number">3</span>][i] = <span class="hljs-built_in">get_output_col4</span>((<span class="hljs-type">uint8_t</span>) i);<br>    }<br>    <span class="hljs-comment">//输出列混淆表</span><br><span class="hljs-comment">//    for(int i=0;i&lt;4;i++) {</span><br><span class="hljs-comment">//        for (int j = 0; j &lt; 256; j++) {</span><br><span class="hljs-comment">//            //printf("%8x ",T[i][j]);</span><br><span class="hljs-comment">//            cout &lt;&lt;setw(8)&lt;&lt;setfill('0')&lt;&lt; hex &lt;&lt; T[i][j] &lt;&lt; " ";</span><br><span class="hljs-comment">//        }</span><br><span class="hljs-comment">//        cout&lt;&lt;endl;</span><br><span class="hljs-comment">//    }</span><br>}<br><br><span class="hljs-function"><span class="hljs-type">uint8_t</span> <span class="hljs-title">GFMul</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> a, <span class="hljs-type">uint8_t</span> b)</span> </span>{<br>    <span class="hljs-type">uint8_t</span> p = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint8_t</span> high;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> counter = <span class="hljs-number">0</span>; counter &lt; <span class="hljs-number">8</span>; counter++)<br>    {<br>        <span class="hljs-keyword">if</span> ((b &amp; <span class="hljs-built_in">uint8_t</span>(<span class="hljs-number">1</span>)) != <span class="hljs-number">0</span>){<span class="hljs-comment">//判断当前b的最后一位是否为0</span><br>            p ^= a;}<span class="hljs-comment">// p与a异或  即如果b当前最后一位不是0，就加上现在的a</span><br>        high = (<span class="hljs-type">uint8_t</span>) (a &amp; <span class="hljs-built_in">uint8_t</span>(<span class="hljs-number">0x80</span>));<span class="hljs-comment">//高4位，看是否会溢出，high=1就是溢出</span><br>        a &lt;&lt;= <span class="hljs-number">1</span>;<span class="hljs-comment">//a左移一位，即乘以2</span><br>        <span class="hljs-keyword">if</span> (high != <span class="hljs-number">0</span>){<span class="hljs-comment">//发生溢出</span><br>            a ^= <span class="hljs-number">0x1b</span>; }<span class="hljs-comment">// x^8 + x^4 + x^3 + x + 1</span><br>        b &gt;&gt;= <span class="hljs-number">1</span>;<span class="hljs-comment">//右移，看b的下一位了</span><br><br>    }<br>    <span class="hljs-keyword">return</span> p;<br>}<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">KeyExpansion</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> key[], <span class="hljs-type">uint32_t</span> w[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> temp=<span class="hljs-number">0</span>;<br>    <span class="hljs-comment">// w[]的前4个就是输入的key</span><br>    <span class="hljs-comment">//初始化w[0]-&gt;w[3]</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>;i++){<br>        w[i] = (key[<span class="hljs-number">4</span>*i]&lt;&lt;<span class="hljs-number">24</span>)|(key[<span class="hljs-number">4</span>*i+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">16</span>)|(key[<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>]&lt;&lt;<span class="hljs-number">8</span>)|(key[<span class="hljs-number">4</span>*i+<span class="hljs-number">3</span>]);<br>        <span class="hljs-comment">//printf("%d:%x\n",i,w[i]);</span><br>    }<br>    <span class="hljs-comment">//创建w[4]-&gt;w[43]</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">4</span>; i&lt;<span class="hljs-number">44</span>;i++){<br>        <span class="hljs-keyword">if</span>(i%<span class="hljs-number">4</span>==<span class="hljs-number">0</span>){<br>            temp = <span class="hljs-built_in">left_bit_move</span>(w[i<span class="hljs-number">-1</span>],<span class="hljs-number">8</span>);<span class="hljs-comment">//循环左移8位</span><br>            temp =  <span class="hljs-built_in">SubKeys</span>(temp);<br>            w[i] = temp ^ w[i<span class="hljs-number">-4</span>] ^ LunMiYaoJia[j++];<br>            <span class="hljs-comment">//printf("%d:%x\n",i,w[i]);</span><br>        }<br>        <span class="hljs-keyword">else</span> {<br>            w[i] = w[i - <span class="hljs-number">1</span>] ^ w[i - <span class="hljs-number">4</span>];<br>            <span class="hljs-comment">//printf("%d:%x\n",i,w[i]);</span><br>        }<br>    }<br>}<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">AddRoundKey</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> mtx[],<span class="hljs-type">uint32_t</span> w[])</span></span><br><span class="hljs-function"></span>{<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; i++){<br>        <span class="hljs-type">uint8_t</span> w1 = w[i] &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">0xff</span>;<br>        <span class="hljs-type">uint8_t</span> w2 = (w[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>;<br>        <span class="hljs-type">uint8_t</span> w3 = (w[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>;<br>        <span class="hljs-type">uint8_t</span> w4 = (w[i]) &amp; <span class="hljs-number">0xff</span>;<br>        mtx[i] ^= w1;  <span class="hljs-comment">//按列异或</span><br>        mtx[i+<span class="hljs-number">4</span>] ^= w2;<br>        mtx[i+<span class="hljs-number">8</span>] ^= w3;<br>        mtx[i+<span class="hljs-number">12</span>] ^= w4;<br>    }<br>}<br><br><span class="hljs-comment">//  S盒密钥变换 - 前4位为行号，后4位为列号</span><br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">SubKeys</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> temp)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">uint8_t</span> w[<span class="hljs-number">4</span>] = {<span class="hljs-number">0</span>};<br>    <span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;<br>    <span class="hljs-comment">//循环4次</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">3</span>; i&gt;=<span class="hljs-number">0</span>; i--){<br>        w[j++] = (temp&gt;&gt;(i*<span class="hljs-number">8</span>))&amp;<span class="hljs-number">0xff</span>;<br>    }<br>    <span class="hljs-built_in">SubBytes</span>(w,<span class="hljs-number">4</span>);<br>    <span class="hljs-keyword">return</span> (w[<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">24</span>|w[<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">16</span>|w[<span class="hljs-number">2</span>]&lt;&lt;<span class="hljs-number">8</span>|w[<span class="hljs-number">3</span>]);<br>}<br><br><span class="hljs-comment">//  S盒变换 - 前4位为行号，后4位为列号</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SubBytes</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> mtx[],<span class="hljs-type">int</span> len)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;len; ++i)<br>    {<br>        <span class="hljs-type">int</span> row = ((mtx[i]&gt;&gt;<span class="hljs-number">7</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">8</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">6</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">4</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">5</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">2</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">4</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">1</span>;    <span class="hljs-comment">//第4 5 6 7位确定行</span><br>        <span class="hljs-type">int</span> col = ((mtx[i]&gt;&gt;<span class="hljs-number">3</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">8</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">2</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">4</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">1</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">2</span> + (mtx[i]&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">1</span>;       <span class="hljs-comment">//第0 1 2 3位确定列</span><br>        mtx[i] = S_Box[row][col];<br>    }<br>}<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InvSubBytes</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> mtx[],<span class="hljs-type">int</span> len)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;len; ++i)<br>    {<br>        <span class="hljs-type">int</span> row = ((mtx[i]&gt;&gt;<span class="hljs-number">7</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">8</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">6</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">4</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">5</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">2</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">4</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">1</span>;    <span class="hljs-comment">//第4 5 6 7位确定行</span><br>        <span class="hljs-type">int</span> col = ((mtx[i]&gt;&gt;<span class="hljs-number">3</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">8</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">2</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">4</span> + ((mtx[i]&gt;&gt;<span class="hljs-number">1</span>)&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">2</span> + (mtx[i]&amp;<span class="hljs-number">0x1</span>)*<span class="hljs-number">1</span>;       <span class="hljs-comment">//第0 1 2 3位确定列</span><br>        mtx[i] = Inv_S_Box[row][col];<br>    }<br>}<br><span class="hljs-comment">//行移位</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ShiftRows</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> mtx[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">uint8_t</span> temp=mtx[<span class="hljs-number">4</span>];<br>    <span class="hljs-comment">//第二行左移一位</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">3</span>; i++){<br>        mtx[i+<span class="hljs-number">4</span>] = mtx[i+<span class="hljs-number">5</span>];<br>    }<br>    mtx[<span class="hljs-number">7</span>] = temp;<br>    <span class="hljs-comment">//第三行左移二位</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">2</span>; i++){<br>        temp = mtx[i+<span class="hljs-number">8</span>];<br>        mtx[i+<span class="hljs-number">8</span>] = mtx[i+<span class="hljs-number">10</span>];<br>        mtx[i+<span class="hljs-number">10</span>] = temp;<br>    }<br>    <span class="hljs-comment">//第四行左移三位</span><br>    temp = mtx[<span class="hljs-number">15</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">3</span>; i&gt;<span class="hljs-number">0</span>; i--) {<br>        mtx[i + <span class="hljs-number">12</span>] = mtx[i + <span class="hljs-number">11</span>];<br>    }<br>    mtx[<span class="hljs-number">12</span>] = temp;<br>}<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InvShiftRows</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> mtx[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-comment">// 第二行循环右移一位</span><br>    <span class="hljs-type">uint8_t</span> temp = mtx[<span class="hljs-number">7</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">3</span>; i&gt;<span class="hljs-number">0</span>; --i)<br>        mtx[i+<span class="hljs-number">4</span>] = mtx[i+<span class="hljs-number">3</span>];<br>    mtx[<span class="hljs-number">4</span>] = temp;<br>    <span class="hljs-comment">// 第三行循环右移两位</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">2</span>; ++i)<br>    {<br>        temp = mtx[i+<span class="hljs-number">8</span>];<br>        mtx[i+<span class="hljs-number">8</span>] = mtx[i+<span class="hljs-number">10</span>];<br>        mtx[i+<span class="hljs-number">10</span>] = temp;<br>    }<br>    <span class="hljs-comment">// 第四行循环右移三位</span><br>    temp = mtx[<span class="hljs-number">12</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">3</span>; ++i)<br>        mtx[i+<span class="hljs-number">12</span>] = mtx[i+<span class="hljs-number">13</span>];<br>    mtx[<span class="hljs-number">15</span>] = temp;<br>}<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MixColumns</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> c[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">uint32_t</span> total[<span class="hljs-number">4</span>]={<span class="hljs-number">0</span>};  <span class="hljs-comment">//存储每一列取出的4个32比特字节异或的结果，即列混淆后的第i列</span><br>    <span class="hljs-type">uint32_t</span> temp[<span class="hljs-number">16</span>]={<span class="hljs-number">0</span>};  <span class="hljs-comment">//存储16个 每个字节从T表得到的32比特的4字节一列</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++){<br>        temp[i] = T[i/<span class="hljs-number">4</span>][c[i]];<br>    }<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>;i++) {<br>        total[i] = temp[i] ^ temp[i+<span class="hljs-number">4</span>] ^ temp[i+<span class="hljs-number">8</span>] ^ temp[i+<span class="hljs-number">12</span>];<br>        c[i] = (total[i]&gt;&gt;<span class="hljs-number">24</span>)&amp;<span class="hljs-number">0xff</span>;<br>        c[i+<span class="hljs-number">4</span>]=(total[i]&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xff</span>;<br>        c[i+<span class="hljs-number">8</span>] = (total[i]&gt;&gt;<span class="hljs-number">8</span>)&amp;<span class="hljs-number">0xff</span>;<br>        c[i+<span class="hljs-number">12</span>] = (total[i])&amp;<span class="hljs-number">0xff</span>;<br>    }<br>}<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InvMixColumns</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> mtx[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">uint8_t</span> arr[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; ++i) {<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; ++j)<br>            arr[j] = mtx[i + j * <span class="hljs-number">4</span>];<br><br>        mtx[i] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0e</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0b</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0d</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x09</span>, arr[<span class="hljs-number">3</span>]);<br>        mtx[i + <span class="hljs-number">4</span>] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x09</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0e</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0b</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0d</span>, arr[<span class="hljs-number">3</span>]);<br>        mtx[i + <span class="hljs-number">8</span>] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0d</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x09</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0e</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0b</span>, arr[<span class="hljs-number">3</span>]);<br>        mtx[i + <span class="hljs-number">12</span>] = <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0b</span>, arr[<span class="hljs-number">0</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0d</span>, arr[<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x09</span>, arr[<span class="hljs-number">2</span>]) ^ <span class="hljs-built_in">GFMul</span>(<span class="hljs-number">0x0e</span>, arr[<span class="hljs-number">3</span>]);<br>    }<br>}<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Encrypt</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> m[],<span class="hljs-type">uint32_t</span> key[],<span class="hljs-type">uint8_t</span> c[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-comment">//首先进行开始的轮密钥加</span><br>    <span class="hljs-type">int</span> round=<span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> w[<span class="hljs-number">4</span>]={<span class="hljs-number">0</span>};<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>; k&lt;<span class="hljs-number">4</span>; k++)<br>        w[k] = key[<span class="hljs-number">4</span>*round+k];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">16</span>; i++)<br>        c[i] = m[i];<br>    <span class="hljs-built_in">AddRoundKey</span>(c,w);<br>    <span class="hljs-comment">//接下来是9轮一摸一样的函数</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">9</span>;i++)<br>    {<br>        <span class="hljs-built_in">SubBytes</span>(c,<span class="hljs-number">16</span>);<span class="hljs-comment">//字节替代</span><br>        <span class="hljs-built_in">ShiftRows</span>(c);<span class="hljs-comment">//行移位</span><br>        <span class="hljs-built_in">MixColumns</span>(c);<span class="hljs-comment">//列混淆</span><br>        round++;<br>        <span class="hljs-comment">//cout&lt;&lt;"轮数"&lt;&lt;round&lt;&lt;endl;</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>; k&lt;<span class="hljs-number">4</span>; k++) {<br>            w[k] = key[<span class="hljs-number">4</span> * round + k];<br>        }<br>        <span class="hljs-built_in">AddRoundKey</span>(c,w);<span class="hljs-comment">//轮密钥加</span><br>    }<br>    <span class="hljs-comment">//最后一轮</span><br>    round++;<br>    <span class="hljs-comment">//cout&lt;&lt;"轮数"&lt;&lt;round&lt;&lt;endl;</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>; k&lt;<span class="hljs-number">4</span>; k++) {<br>        w[k] = key[<span class="hljs-number">4</span> * round + k];<br>        <span class="hljs-comment">//("%x ",w[k]);</span><br>    }<br>    <span class="hljs-built_in">SubBytes</span>(c,<span class="hljs-number">16</span>);<span class="hljs-comment">//字节替代</span><br>    <span class="hljs-built_in">ShiftRows</span>(c);<span class="hljs-comment">//行移位</span><br>    <span class="hljs-built_in">AddRoundKey</span>(c,w);<span class="hljs-comment">//轮密钥加</span><br>}<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Decrypt</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> c[],<span class="hljs-type">uint32_t</span> key[],<span class="hljs-type">uint8_t</span> m[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-comment">//首先进行开始的轮密钥加</span><br>    <span class="hljs-comment">//注意密钥反着来</span><br>    <span class="hljs-type">int</span> round=<span class="hljs-number">10</span>;<br>    <span class="hljs-type">uint32_t</span> w[<span class="hljs-number">4</span>]={<span class="hljs-number">0</span>};<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>; k&lt;<span class="hljs-number">4</span>; k++)<br>        w[k] = key[<span class="hljs-number">4</span>*round+k];  <span class="hljs-comment">//密钥赋值</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">16</span>; i++)<br>        m[i] = c[i];<br>    <span class="hljs-built_in">AddRoundKey</span>(m,w);<br>    <span class="hljs-comment">//接下来是9轮一摸一样的函数</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">9</span>;i++)<br>    {<br>        <span class="hljs-built_in">InvShiftRows</span>(m);<span class="hljs-comment">//行移位</span><br>        <span class="hljs-built_in">InvSubBytes</span>(m,<span class="hljs-number">16</span>);<span class="hljs-comment">//字节替代</span><br>        round--;<br>        <span class="hljs-comment">//cout&lt;&lt;"轮数"&lt;&lt;round&lt;&lt;endl;</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>; k&lt;<span class="hljs-number">4</span>; k++) {<br>            w[k] = key[<span class="hljs-number">4</span> * round + k];<br>        }<br>        <span class="hljs-built_in">AddRoundKey</span>(m,w);<span class="hljs-comment">//轮密钥加</span><br>        <span class="hljs-built_in">InvMixColumns</span>(m);<span class="hljs-comment">//列混淆</span><br>    }<br>    <span class="hljs-comment">//最后一轮</span><br>    round--;<br>    <span class="hljs-comment">//cout&lt;&lt;"轮数"&lt;&lt;round&lt;&lt;endl;</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>; k&lt;<span class="hljs-number">4</span>; k++) {<br>        w[k] = key[<span class="hljs-number">4</span> * round + k];<br>        <span class="hljs-comment">//("%x ",w[k]);</span><br>    }<br>    <span class="hljs-built_in">InvShiftRows</span>(m);<span class="hljs-comment">//行移位</span><br>    <span class="hljs-built_in">InvSubBytes</span>(m,<span class="hljs-number">16</span>);<span class="hljs-comment">//字节替代</span><br>    <span class="hljs-built_in">AddRoundKey</span>(m,w);<span class="hljs-comment">//轮密钥加</span><br>}<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Display</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> Matrix[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">16</span>; i++) {<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%x "</span>, Matrix[i]);<br>        <span class="hljs-keyword">if</span>(i%<span class="hljs-number">4</span>==<span class="hljs-number">3</span>)<br>            cout&lt;&lt;endl;<br>    }<br>}<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DisplayKeys</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> Matrix[])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">44</span>; i++) {<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"第%d列:%x\n"</span>,i,Matrix[i]);<br>    }<br>}<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>{<br>    string mingwen;<br>    string miwen;<br>    <span class="hljs-type">uint8_t</span> key[<span class="hljs-number">16</span>]={<span class="hljs-number">0</span>};<br>    <span class="hljs-type">uint8_t</span> m[<span class="hljs-number">16</span>]={<span class="hljs-number">0</span>};<br>    cout&lt;&lt;<span class="hljs-string">"请输入明文(128bits):"</span>;<br>    cin&gt;&gt;mingwen;<br>    cout&lt;&lt;<span class="hljs-string">"请输入密文(128bits):"</span>;<br>    cin&gt;&gt;miwen;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++)<br>    {<br>        m[i] = (<span class="hljs-type">uint8_t</span>)(mingwen[i]);<br>        key[i] = (<span class="hljs-type">uint8_t</span>)(miwen[i]);<br>    }<br>    <span class="hljs-type">uint8_t</span> c[<span class="hljs-number">16</span>]={<span class="hljs-number">0</span>};<br>    <span class="hljs-type">uint8_t</span> x[<span class="hljs-number">16</span>]={<span class="hljs-number">0</span>};<br>    <span class="hljs-type">uint32_t</span> new_key[<span class="hljs-number">44</span>]={<span class="hljs-number">0</span>};   <span class="hljs-comment">//存储44列密钥</span><br>    cout&lt;&lt;<span class="hljs-string">"明文:"</span>&lt;&lt;endl;<br>    <span class="hljs-built_in">Display</span>(m);<br>    cout&lt;&lt;<span class="hljs-string">"密钥:"</span>&lt;&lt;endl;<br>    <span class="hljs-built_in">Display</span>(key);<br>    <span class="hljs-built_in">get_TAB</span>();<span class="hljs-comment">//生成列混淆表</span><br>    <span class="hljs-built_in">KeyExpansion</span>(key,new_key);<br>    cout&lt;&lt;<span class="hljs-string">"生成密钥"</span>&lt;&lt;endl;<br>    <span class="hljs-comment">//DisplayKeys(new_key);</span><br>    <span class="hljs-built_in">Encrypt</span>(m,new_key,c);<br>    cout&lt;&lt;<span class="hljs-string">"加密结果"</span>&lt;&lt;endl;<br>    <span class="hljs-built_in">Display</span>(c);<br>    <span class="hljs-built_in">Decrypt</span>(c,new_key,x);<br>    cout&lt;&lt;<span class="hljs-string">"解密结果(hex)"</span>&lt;&lt;endl;<br>    <span class="hljs-built_in">Display</span>(x);<br>    cout&lt;&lt;<span class="hljs-string">"解密结果(string)"</span>&lt;&lt;endl;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++)<br>        cout&lt;&lt;(<span class="hljs-type">char</span>)x[i];<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>}<br></code></pre></td></tr></tbody></table></figure>





<h2 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"string.h"</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">shift_l</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> s,<span class="hljs-type">int</span> n)</span><span class="hljs-comment">//循环左移n位</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">int</span> size=<span class="hljs-built_in">sizeof</span> (s)*<span class="hljs-number">8</span>;      <span class="hljs-comment">//字节数乘以8代表一共多少位</span><br>    <span class="hljs-keyword">return</span> s&lt;&lt;(n)|(s&gt;&gt;size-n);<br>}<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">Sb</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> s)</span> </span>{<br><br>    <span class="hljs-type">uint8_t</span> SboxTable[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>] =<br>            {<br>                    {<span class="hljs-number">0xd6</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x05</span>},<br>                    {<span class="hljs-number">0x2b</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x99</span>},<br>                    {<span class="hljs-number">0x9c</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x62</span>},<br>                    {<span class="hljs-number">0xe4</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0xa6</span>},<br>                    {<span class="hljs-number">0x47</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0xa8</span>},<br>                    {<span class="hljs-number">0x68</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x35</span>},<br>                    {<span class="hljs-number">0x1e</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x87</span>},<br>                    {<span class="hljs-number">0xd4</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x9e</span>},<br>                    {<span class="hljs-number">0xea</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xa1</span>},<br>                    {<span class="hljs-number">0xe0</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0xe3</span>},<br>                    {<span class="hljs-number">0x1d</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x6f</span>},<br>                    {<span class="hljs-number">0xd5</span>, <span class="hljs-number">0xdb</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x51</span>},<br>                    {<span class="hljs-number">0x8d</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xd8</span>},<br>                    {<span class="hljs-number">0x0a</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xb0</span>},<br>                    {<span class="hljs-number">0x89</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x84</span>},<br>                    {<span class="hljs-number">0x18</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x48</span>}};<br>    <span class="hljs-type">uint8_t</span> a[<span class="hljs-number">4</span>];<br>    a[<span class="hljs-number">0</span>]=(s&gt;&gt;<span class="hljs-number">24</span>)&amp;<span class="hljs-number">0xff</span>;     <span class="hljs-comment">//最高8位</span><br>    a[<span class="hljs-number">1</span>]=(s&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xff</span>;<br>    a[<span class="hljs-number">2</span>]=(s&gt;&gt;<span class="hljs-number">8</span>)&amp;<span class="hljs-number">0xff</span>;<br>    a[<span class="hljs-number">3</span>]=s&amp;<span class="hljs-number">0xff</span>;<br>    <span class="hljs-type">uint8_t</span> b[<span class="hljs-number">4</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++) {<br>        <span class="hljs-type">int</span> row = ((a[i] &gt;&gt; <span class="hljs-number">7</span>) &amp; <span class="hljs-number">1</span>) * <span class="hljs-number">8</span> + ((a[i] &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">1</span>) * <span class="hljs-number">4</span> + ((a[i] &gt;&gt; <span class="hljs-number">5</span>) &amp; <span class="hljs-number">1</span>) * <span class="hljs-number">2</span> + ((a[i] &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">1</span>) * <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> col = ((a[i] &gt;&gt; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">1</span>) * <span class="hljs-number">8</span> + ((a[i] &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">1</span>) * <span class="hljs-number">4</span> + ((a[i] &gt;&gt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>) * <span class="hljs-number">2</span> + ((a[i]) &amp; <span class="hljs-number">1</span>) * <span class="hljs-number">1</span>;<br>        b[i] = SboxTable[row][col];<br>    }<br>    <span class="hljs-type">uint32_t</span> result;<br>    result=(b[<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">24</span>)|(b[<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">16</span>)|(b[<span class="hljs-number">2</span>]&lt;&lt;<span class="hljs-number">8</span>)|b[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">return</span> result;<br>}<br><br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">L_change</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> s)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">return</span> s^ <span class="hljs-built_in">shift_l</span>(s,<span class="hljs-number">13</span>)^ <span class="hljs-built_in">shift_l</span>(s,<span class="hljs-number">23</span>);<br>}<br><br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">T_change</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> s)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">L_change</span>(<span class="hljs-built_in">Sb</span>(s));<br>}<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">keyexpand</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> MK[<span class="hljs-number">4</span>],<span class="hljs-type">uint32_t</span> rk[<span class="hljs-number">32</span>])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">uint32_t</span> FK[<span class="hljs-number">4</span>]={<span class="hljs-number">0xA3B1BAC6</span>, <span class="hljs-number">0x56AA3350</span>,<span class="hljs-number">0x677D9197</span>, <span class="hljs-number">0xB27022DC</span>};<br>    <span class="hljs-type">uint32_t</span> CK[<span class="hljs-number">32</span>] = { <span class="hljs-number">0x00070E15</span>, <span class="hljs-number">0x1C232A31</span>, <span class="hljs-number">0x383F464D</span>, <span class="hljs-number">0x545B6269</span>,<br>                        <span class="hljs-number">0x70777E85</span>, <span class="hljs-number">0x8C939AA1</span>, <span class="hljs-number">0xA8AFB6BD</span>, <span class="hljs-number">0xC4CBD2D9</span>,<br>                        <span class="hljs-number">0xE0E7EEF5</span>, <span class="hljs-number">0xFC030A11</span>, <span class="hljs-number">0x181F262D</span>, <span class="hljs-number">0x343B4249</span>,<br>                        <span class="hljs-number">0x50575E65</span>, <span class="hljs-number">0x6C737A81</span>, <span class="hljs-number">0x888F969D</span>, <span class="hljs-number">0xA4ABB2B9</span>,<br>                        <span class="hljs-number">0xC0C7CED5</span>, <span class="hljs-number">0xDCE3EAF1</span>, <span class="hljs-number">0xF8FF060D</span>, <span class="hljs-number">0x141B2229</span>,<br>                        <span class="hljs-number">0x30373E45</span>, <span class="hljs-number">0x4C535A61</span>, <span class="hljs-number">0x686F767D</span>, <span class="hljs-number">0x848B9299</span>,<br>                        <span class="hljs-number">0xA0A7AEB5</span>, <span class="hljs-number">0xBCC3CAD1</span>, <span class="hljs-number">0xD8DFE6ED</span>, <span class="hljs-number">0xF4FB0209</span>,<br>                        <span class="hljs-number">0x10171E25</span>, <span class="hljs-number">0x2C333A41</span>, <span class="hljs-number">0x484F565D</span>, <span class="hljs-number">0x646B7279</span> };<br>    <span class="hljs-type">uint32_t</span> k[<span class="hljs-number">4</span>]={MK[<span class="hljs-number">0</span>]^FK[<span class="hljs-number">0</span>],MK[<span class="hljs-number">1</span>]^FK[<span class="hljs-number">1</span>],MK[<span class="hljs-number">2</span>]^FK[<span class="hljs-number">2</span>],MK[<span class="hljs-number">3</span>]^FK[<span class="hljs-number">3</span>]};<br>    <span class="hljs-type">uint32_t</span> K[<span class="hljs-number">36</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">3</span>;i++)<br>        K[i]=k[i];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)<br>    {<br>        K[i+<span class="hljs-number">4</span>]=K[i]^ <span class="hljs-built_in">T_change</span>(K[i+<span class="hljs-number">1</span>]^K[i+<span class="hljs-number">2</span>]^K[i+<span class="hljs-number">3</span>]^CK[i]);<br>    }<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)<br>        rk[i]=K[i+<span class="hljs-number">4</span>];<br><br>}<br><br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">Lchange</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> s)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">return</span> s^<span class="hljs-built_in">shift_l</span>(s,<span class="hljs-number">2</span>)^<span class="hljs-built_in">shift_l</span>(s,<span class="hljs-number">10</span>)^<span class="hljs-built_in">shift_l</span>(s,<span class="hljs-number">18</span>)^<span class="hljs-built_in">shift_l</span>(s,<span class="hljs-number">24</span>);<br>}<br><br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">Tchange</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> s)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Lchange</span>(<span class="hljs-built_in">Sb</span>(s));<br>}<br><br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">fround</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> X[<span class="hljs-number">4</span>],<span class="hljs-type">uint32_t</span> rk)</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">uint32_t</span> B=X[<span class="hljs-number">1</span>]^X[<span class="hljs-number">2</span>]^X[<span class="hljs-number">3</span>]^rk;<br>    <span class="hljs-keyword">return</span> X[<span class="hljs-number">0</span>]^ <span class="hljs-built_in">L_change</span>(<span class="hljs-built_in">Sb</span>(B));<br>}<br><br><span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> out1[<span class="hljs-number">4</span>];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SM4</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> X[<span class="hljs-number">4</span>],<span class="hljs-type">uint32_t</span> rk[<span class="hljs-number">32</span>])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">uint32_t</span> Y[<span class="hljs-number">36</span>];<br>    Y[<span class="hljs-number">0</span>]=X[<span class="hljs-number">0</span>];<br>    Y[<span class="hljs-number">1</span>]=X[<span class="hljs-number">1</span>];<br>    Y[<span class="hljs-number">2</span>]=X[<span class="hljs-number">2</span>];<br>    Y[<span class="hljs-number">3</span>]=X[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=<span class="hljs-number">31</span>;i++) {<br>        Y[i + <span class="hljs-number">4</span>] = Y[i] ^ <span class="hljs-built_in">Tchange</span>(Y[i + <span class="hljs-number">1</span>] ^ Y[i + <span class="hljs-number">2</span>] ^ Y[i + <span class="hljs-number">3</span>] ^ rk[i]);<br>    }<br><span class="hljs-comment">//    for(int i=0;i&lt;36;i++) {</span><br><span class="hljs-comment">//        printf("第%d轮:%x \n",i,Y[i]);</span><br><span class="hljs-comment">//    }</span><br>    out1[<span class="hljs-number">0</span>]=Y[<span class="hljs-number">35</span>];<br>    out1[<span class="hljs-number">1</span>]=Y[<span class="hljs-number">34</span>];<br>    out1[<span class="hljs-number">2</span>]=Y[<span class="hljs-number">33</span>];<br>    out1[<span class="hljs-number">3</span>]=Y[<span class="hljs-number">32</span>];<br>}<br><br><span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> out2[<span class="hljs-number">4</span>];<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">sm4</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> Y[<span class="hljs-number">4</span>],<span class="hljs-type">uint32_t</span> rk[<span class="hljs-number">32</span>])</span></span><br><span class="hljs-function"></span>{<br>    <span class="hljs-type">uint32_t</span> X[<span class="hljs-number">36</span>];<br>    X[<span class="hljs-number">35</span>]=Y[<span class="hljs-number">0</span>];<br>    X[<span class="hljs-number">34</span>]=Y[<span class="hljs-number">1</span>];<br>    X[<span class="hljs-number">33</span>]=Y[<span class="hljs-number">2</span>];<br>    X[<span class="hljs-number">32</span>]=Y[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">31</span>;i&gt;=<span class="hljs-number">0</span>;i--)<br>    {<br>        X[i]=X[i+<span class="hljs-number">4</span>]^ <span class="hljs-built_in">Tchange</span>(X[i+<span class="hljs-number">3</span>]^X[i+<span class="hljs-number">2</span>]^X[i+<span class="hljs-number">1</span>]^rk[i]);<br>    }<br>    out2[<span class="hljs-number">0</span>]=X[<span class="hljs-number">0</span>];<br>    out2[<span class="hljs-number">1</span>]=X[<span class="hljs-number">1</span>];<br>    out2[<span class="hljs-number">2</span>]=X[<span class="hljs-number">2</span>];<br>    out2[<span class="hljs-number">3</span>]=X[<span class="hljs-number">3</span>];<br>}<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{<br>    <span class="hljs-type">uint32_t</span> ming[<span class="hljs-number">4</span>]={<span class="hljs-number">0x01234567</span>,<span class="hljs-number">0x89ABCDEF</span>,<span class="hljs-number">0xFEDCBA98</span>,<span class="hljs-number">0x76543210</span>};<br>    cout&lt;&lt;<span class="hljs-string">"明文:"</span>&lt;&lt;endl;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>        cout&lt;&lt;hex&lt;&lt;ming[i]&lt;&lt;<span class="hljs-string">" "</span>;<br>    cout&lt;&lt;endl;<br>    <span class="hljs-type">uint32_t</span> MK[<span class="hljs-number">4</span>]={<span class="hljs-number">0x01234567</span>,<span class="hljs-number">0x89ABCDEF</span>,<span class="hljs-number">0xFEDCBA98</span>,<span class="hljs-number">0x76543210</span>};<br>    cout&lt;&lt;<span class="hljs-string">"密钥："</span>&lt;&lt;endl;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>        cout&lt;&lt;hex&lt;&lt;MK[i]&lt;&lt;<span class="hljs-string">" "</span>;<br>    cout&lt;&lt;endl;<br>    <span class="hljs-type">uint32_t</span> rk[<span class="hljs-number">32</span>];<br>    <span class="hljs-built_in">keyexpand</span>(MK,rk);<br><span class="hljs-comment">//    cout&lt;&lt;"扩展密钥："&lt;&lt;endl;</span><br><span class="hljs-comment">//    for(int i=0;i&lt;32;i++)</span><br><span class="hljs-comment">//        cout&lt;&lt;i&lt;&lt;"轮扩展密钥"&lt;&lt;rk[i]&lt;&lt;endl;</span><br>    cout&lt;&lt;<span class="hljs-string">"加密结果："</span>&lt;&lt;endl;<br>    <span class="hljs-built_in">SM4</span>(ming,rk);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>        cout&lt;&lt;out1[i]&lt;&lt;<span class="hljs-string">" "</span>;<br>    cout&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">"解密结果:"</span>&lt;&lt;endl;<br>    <span class="hljs-built_in">sm4</span>(out1,rk);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>        cout&lt;&lt;out2[i]&lt;&lt;<span class="hljs-string">" "</span>;<br>    cout&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>}<br><br></code></pre></td></tr></tbody></table></figure>

<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/04/10/double%20free/">← Next doublefree</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/04/09/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%88%B7%E9%A2%98%E6%80%BB%E7%BB%93/">蓝桥杯 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Kylinxin</a></h1><div id="description"><p>当你觉得生活都不顺心如意的时候，来学习pwn吧！</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#DES"><span class="toc-number">1.</span> <span class="toc-text">DES</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AES"><span class="toc-number">2.</span> <span class="toc-text">AES</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SM4"><span class="toc-number">3.</span> <span class="toc-text">SM4</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>